<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>CogComp-NLP demo</title>

    <link rel="stylesheet" type="text/css" href="./brat_client/static/style-vis.css"/>
    <link rel="stylesheet" type="text/css" href="./main.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.0/gh-fork-ribbon.min.css"/>
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.2/css/bootstrap-select.min.css">


    <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/headjs/1.0.3/head.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.2/js/bootstrap-select.min.js"></script>
    <script src="/apelles.js" type="text/javascript"></script>
</head>
<body>
<a href="https://github.com/CogComp/cogcomp-nlp/" class="github-corner" aria-label="View source on Github">
    <svg width="80" height="80" viewBox="0 0 250 250"
         style="height: 100px; width: 100px; fill:#000000; color:#fff; position: absolute; top: 0; right: 0; border: 0;"
         aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path
          d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
          fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path
          d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
          fill="currentColor" class="octo-body"></path>
    </svg>
</a>
<style>.github-corner:hover .octo-arm {
    animation: octocat-wave 560ms ease-in-out
}

@keyframes octocat-wave {
    0%, 100% {
        transform: rotate(0)
    }
    20%, 60% {
        transform: rotate(-25deg)
    }
    40%, 80% {
        transform: rotate(10deg)
    }
}

@media (max-width: 500px) {
    .github-corner:hover .octo-arm {
        animation: none
    }

    .github-corner .octo-arm {
        animation: octocat-wave 560ms ease-in-out
    }
}</style>
<div class="container">
    <div class="jumbotron">
        <div style="float: right">
            <iframe
              src="https://ghbtns.com/github-btn.html?user=CogComp&repo=cogcomp-nlp&type=star&count=true&size=large"
              frameborder="0" scrolling="0" width="160px" height="30px" style="margin-right: -20px"></iframe>
            <iframe
              src="https://ghbtns.com/github-btn.html?user=CogComp&repo=cogcomp-nlp&type=fork&count=true&size=large"
              frameborder="0" scrolling="0" width="158px" height="30px" style="margin-right: -20px"></iframe>
        </div>
        <h1><a href="/" style="text-decoration: none">CogComp-NLP</a></h1>
        <p>
            CogComp-NLP provides a suite of state-of-the-art Natural Language Processing (NLP) tools
            that allows you to annotate plain text inputs.
            <button type="button" onclick="location.href='https://github.com/CogComp/cogcomp-nlp/tree/master/pipeline';"
                    class="btn btn-danger btn-xs">Read More
            </button>
            <div class="wrap">
        <p>
            <img src="python.png" style="height: 40px"/>
            Python user? We have a Python API too!
            <button type="button" onclick="location.href='https://github.com/CogComp/cogcomp-nlpy/';"
                    class="btn btn-danger btn-xs">Read More
            </button>
        </p>
        <div style="clear: both;"></div>
    </div>
    </p>
    <div id="loader_container" style="height: 30px; margin-left: 50%">
        <div class="loader" id="loader-main"></div>
    </div>
</div>
<div id="main-content" style="overflow: visible;">
    <div>Enter text to annotate below <span style="font-size: smaller">(1500 characters limit)</span>, or select a
        sample document:
        <div class="dropdown">
            <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1"
                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                Sample Documents
                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" id="dropdownMenuArea1" aria-labelledby="dropdownMenu1">
            </ul>
        </div>
    </div>
    <div id="input-area" style="width: 100%">
        <textarea id="viz-text" maxlength="1500" rows="8" cols="80" style="width: 100%"
                  class="form-control"> </textarea>
        <br>
        <input type="submit" class="btn btn-success" id="viz-submit">
        <select class="selectpicker" id="view-selector" multiple data-actions-box="true" data-live-search="true"
                data-header="Select at least one annotator" multiple>
            <option value="LEMMA">LEMMA</option>
            <option value="POS" selected>POS</option>
            <option value="SHALLOW_PARSE">Shallow Parse</option>
            <option value="MENTION">Mention Detection</option>
            <option value="RELATION">Relation Extraction (ACE-2005)</option>
            <option value="NER_CONLL">NER (CoNLL)</option>
            <option value="NER_ONTONOTES">NER (Ontonotes)</option>
            <option value="TIMEX3">Temporal Normalizer</option>
            <option value="SRL_NOM">SRL (Nom)</option>
            <option value="SRL_VERB">SRL (Verb)</option>
            <option value="PATH_LSTM_SRL">SRL (Path-LSTM)</option>
            <option value="SRL_PREP">SRL (preposition)</option>
            <option value="SRL_COMMA">SRL (Comma)</option>
            <option value="QUANTITIES">Quantities</option>
            <option value="DEPENDENCY">Dependency Tree</option>
            <option value="TRANSLITERATION" id="trans-opt">Transliteration</option>
            <option data-divider="true"></option>
            <option value="DEPENDENCY_STANFORD">Dependency Tree (Stanford)</option>
            <option value="STANFORD_COREF">Co-reference (Stanford)</option>
            <option value="STANFORD_RELATIONS">Relations (Stanford)</option>
            <option value="STANFORD_OPENIE">Open IE (Stanford)</option>
            <!--<option value="PARSE_STANFORD">Parse Tree (Stanford) </option>-->
        </select>
        <div id="transliteration-selector-div" style="display: none">
            <select class="selectpicker" id="transliteration-selector" data-actions-box="true" data-live-search="true"
                    data-header="Transliteration Language: ">
                <option value="TRANSLITERATION_abk">Abkhazian</option>
                <option value="TRANSLITERATION_afr">Afrikaans</option>
                <option value="TRANSLITERATION_ara" selected>Arabic</option>
                <option value="TRANSLITERATION_arg">Aragonese</option>
                <option value="TRANSLITERATION_arz">Egyptian_Arabic</option>
                <option value="TRANSLITERATION_ast">Asturian</option>
                <option value="TRANSLITERATION_aze">Azerbaijani</option>
                <option value="TRANSLITERATION_bak">Bashkir</option>
                <option value="TRANSLITERATION_bel">Belarusian</option>
                <option value="TRANSLITERATION_ben">Bengali</option>
                <option value="TRANSLITERATION_bos">Bosnian</option>
                <option value="TRANSLITERATION_bre">Breton</option>
                <option value="TRANSLITERATION_bul">Bulgarian</option>
                <option value="TRANSLITERATION_cat">Valencian</option>
                <option value="TRANSLITERATION_ces">Czech</option>
                <option value="TRANSLITERATION_che">Chechen</option>
                <option value="TRANSLITERATION_chv">Chuvash</option>
                <option value="TRANSLITERATION_ckb">Sorani</option>
                <option value="TRANSLITERATION_dan">Danish</option>
                <option value="TRANSLITERATION_ell">Greek</option>
                <option value="TRANSLITERATION_epo">Esperanto</option>
                <option value="TRANSLITERATION_est">Estonian</option>
                <option value="TRANSLITERATION_eus">Basque</option>
                <option value="TRANSLITERATION_fas">Persian</option>
                <option value="TRANSLITERATION_fin">Finnish</option>
                <option value="TRANSLITERATION_fra">French</option>
                <option value="TRANSLITERATION_fry">Western_Frisian</option>
                <option value="TRANSLITERATION_glg">Galician</option>
                <option value="TRANSLITERATION_guj">Gujarati</option>
                <option value="TRANSLITERATION_hat">Haitian</option>
                <option value="TRANSLITERATION_heb">Hebrew</option>
                <option value="TRANSLITERATION_hrv">Croatian</option>
                <option value="TRANSLITERATION_hsb">Upper_Sorbian</option>
                <option value="TRANSLITERATION_hun">Hungarian</option>
                <option value="TRANSLITERATION_hye">Armenian</option>
                <option value="TRANSLITERATION_ina">Interlingua</option>
                <option value="TRANSLITERATION_ind">Indonesian</option>
                <option value="TRANSLITERATION_isl">Icelandic</option>
                <option value="TRANSLITERATION_jav">Javanese</option>
                <option value="TRANSLITERATION_kat">Georgian</option>
                <option value="TRANSLITERATION_kaz">Kazakh</option>
                <option value="TRANSLITERATION_kbd">Kabardian</option>
                <option value="TRANSLITERATION_kir">Kirghiz</option>
                <option value="TRANSLITERATION_kur">Kurdish</option>
                <option value="TRANSLITERATION_lat">Latin</option>
                <option value="TRANSLITERATION_lav">Latvian</option>
                <option value="TRANSLITERATION_lim">Limburgish</option>
                <option value="TRANSLITERATION_lit">Lithuanian</option>
                <option value="TRANSLITERATION_ltz">Luxembourgish</option>
                <option value="TRANSLITERATION_mai">Maithili</option>
                <option value="TRANSLITERATION_mar">Marathi</option>
                <option value="TRANSLITERATION_mkd">Macedonian</option>
                <option value="TRANSLITERATION_mlg">Malagasy</option>
                <option value="TRANSLITERATION_mon">Mongolian</option>
                <option value="TRANSLITERATION_msa">Malay</option>
                <option value="TRANSLITERATION_mzn">Mazandarani</option>
                <option value="TRANSLITERATION_nah">Nahuatl</option>
                <option value="TRANSLITERATION_nep">Nepali</option>
                <option value="TRANSLITERATION_nno">Norwegian_Nynorsk</option>
                <option value="TRANSLITERATION_oci">Occitan</option>
                <option value="TRANSLITERATION_ori">Oriya</option>
                <option value="TRANSLITERATION_oss">Ossetian</option>
                <option value="TRANSLITERATION_pan">Punjabi</option>
                <option value="TRANSLITERATION_pol">Polish</option>
                <option value="TRANSLITERATION_por">Portuguese</option>
                <option value="TRANSLITERATION_que">Quechua</option>
                <option value="TRANSLITERATION_roh">Romansh</option>
                <option value="TRANSLITERATION_ron">Romanian</option>
                <option value="TRANSLITERATION_rus">Russian</option>
                <option value="TRANSLITERATION_scn">Sicilian</option>
                <option value="TRANSLITERATION_sco">Scots</option>
                <option value="TRANSLITERATION_slk">Slovak</option>
                <option value="TRANSLITERATION_slv">Slovenian</option>
                <option value="TRANSLITERATION_som">Somali</option>
                <option value="TRANSLITERATION_spa">Castilian</option>
                <option value="TRANSLITERATION_sqi">Albanian</option>
                <option value="TRANSLITERATION_srp">Serbian</option>
                <option value="TRANSLITERATION_sun">Sundanese</option>
                <option value="TRANSLITERATION_swa">Swahili</option>
                <option value="TRANSLITERATION_swe">Swedish</option>
                <option value="TRANSLITERATION_tam">Tamil</option>
                <option value="TRANSLITERATION_tel">Telugu</option>
                <option value="TRANSLITERATION_tgk">Tajik</option>
                <option value="TRANSLITERATION_tgl">Tagalog</option>
                <option value="TRANSLITERATION_tuk">Turkmen</option>
                <option value="TRANSLITERATION_tur">Turkish</option>
                <option value="TRANSLITERATION_ukr">Ukrainian</option>
                <option value="TRANSLITERATION_urd">Urdu</option>
                <option value="TRANSLITERATION_uzb">Uzbek</option>
                <option value="TRANSLITERATION_vie">Vietnamese</option>
                <option value="TRANSLITERATION_war">Waray</option>
                <option value="TRANSLITERATION_wln">Walloon</option>
                <option value="TRANSLITERATION_yid">Yiddish</option>
                <option value="TRANSLITERATION_zza">Zazaki</option>
            </select>
        </div>
        <button type="button" class="btn btn-default" data-toggle="popover" title="Share the content"
                data-html="true" id="main-popover" data-content="">Link to page
        </button>
    </div>
    <div id="render-area"></div>
</div>
<div class="alert alert-danger" id="comeLater" style="text-align: center; display: none" role="alert">
    Servers unresponsive. Come back later!
    <div><img src="why3.png" alt="Why....." style="height: 200px; margin-top: 10px"></div>
</div>
<div class="alert alert-danger" id="warning" style="text-align: center; display: none" role="alert">
    Warning: external-annotations server is off Ugh.
</div>
<textarea id="svg-code" style="height: 0.0cm; opacity: 0.0"></textarea>
<div class="alert alert-warning" style="text-align: center" role="alert">
    Problems? Use our <a href="https://github.com/CogComp/cogcomp-nlp/issues">issue tracker</a>.
</div>

<div id="render-info" style="visibility: hidden;">{{_content_rendered_}}</div>
<div id="render-text" style="visibility: hidden;">{{text}}</div>
<div id="render-views" style="visibility: hidden;">{{viewNames}}</div>

<script type="text/javascript">
    var clipboard = new apelles.cb('.btn'); // copy to the clipboard initialization
    clipboard.on('success', function (e) {
        e.clearSelection();
    });

    var page_rendered = true;
    if ($("#render-info").text().includes("_content_rendered_")) {
        page_rendered = false;
    }

    var pipelineServer = "http://austen.cs.illinois.edu:8080/annotate";
    var externalAnnotatorServers = [
        "http://bronte.cs.illinois.edu:1503/annotate", // stanford
        "http://bronte.cs.illinois.edu:8009/annotate" // path-lstm
    ];

    // for each external annotator, add a loader
    externalAnnotatorServers.forEach(function (item, i) {
        var loaderDiv = $("#loader_container");
        loaderDiv.append("<div class='loader' id='loader-ex-" + i + "'></div>");
    });

    // Return an array of the selected opion values
    // select is an HTML select element
    function getSelectValues(select) {
        var result = [];
        var options = select && select.options;
        var opt;
        for (var i = 0, iLen = options.length; i < iLen; i++) {
            opt = options[i];
            if (opt.selected) {
                result.push(opt.value || opt.text);
            }
        }
        return result;
    }

    /**
     * @param select is the selector object
     * @param viewNames is a Set
     */
    function setSelectValues(select, viewNames) {
        var options = select && select.options;
        for (var i = 0, iLen = options.length; i < iLen; i++) {
            if (viewNames.has(options[i].value)) {
                options[i].setAttribute("selected", "true");
                options[i].selected = true;
            }
            else {
                options[i].setAttribute("selected", "false");
                options[i].selected = false;
            }
        }
    }

    $('.selectpicker').on('change', function () {
        if ($("#trans-opt")[0].selected) {
            $("#transliteration-selector-div").css("display", "inline");
        }
        else {
            $("#transliteration-selector-div").css("display", "none");
        }
    });

    fetch(pipelineServer)
      .then(function () {
          console.log("Connection works. ");
      }).catch(function () {
        document.getElementById("comeLater").style.display = "block";
    });

    externalAnnotatorServers.forEach(function (url) {
        fetch(url)
          .then(function () {
              console.log("Connection works. ");
          }).catch(function () {
            document.getElementById("warning").style.display = "block";
        });
    });

    head.ready(function () {
        console.log('Loading and rendering');

        const _ = apelles.lodash;

        const bratLocation = './brat_client';
        const brat_options = {
            'brat_util': Util,
            'brat_webFontURLs': [
                bratLocation + '/static/fonts/PT_Sans-Caption-Web-Regular.ttf',
                bratLocation + '/static/fonts/Liberation_Sans-Regular.ttf'
            ]
        };

        var sampleSentences = [
            "The boy gave the frog to the girl. The boy's gift was to the girl. The girl was given a frog. ",
            "A squirrel is storing a lot of nuts to prepare for a seasonal change in the environment. ",
            "The construction of the John Smith library finished on time.",
            "Amanda found herself in the Winnebago with her ex-boyfriend, an herbalist and a pet detective. Rome is in Lazio province and Naples in Campania. The region at the end of 2014 had a population of around 5,869,000 people, making it the third-most-populous region of Italy. ",
            "Rome is in Lazio province and Naples in Campania. The region at the end of 2014 had a population of around 5,869,000 people, making it the third-most-populous region of Italy. ",
            "Harvey made landfall Friday night near Rockport, Texas, north of Corpus Christi, as the first Category 4 hurricane to landfall in the U.S. since Charley in August 2004.  Harvey's center of circulation is currently located near Victoria, Texas, only roughly 50 miles from where it made landfall late Friday night. mph reported Saturday morning near Victoria. A Texas Coastal Ocean Observing Network station at Aransas Pass reported sustained winds of 102 mph and a wind gust of 132 mph Friday night. Rainfall amounts of more than 10 inches have already accumulated in southeast Texas, including 14.46 inches near Austwell.",
            "The stocks declined on Tuesday . John declined the cake .",
            "The flu season is winding down, and it has killed 105 children so far - about the average toll. The season started about a month earlier than usual, sparking concerns it might turn into the worst in a decade. It ended up being very hard on the elderly, but was moderately severe overall, according to the Centers for Disease Control and Prevention. Six of the pediatric deaths were reported in the last week, and it's possible there will be more, said the CDC's Dr. Michael Jhung said Friday. All but four of the children who died were old enough to be vaccinated, but 90 percent of them did not get vaccinated, CDC officials said. This year's vaccine was considered effective in children, though it didn't work very well in older people. In that group, 177 out of every 100,000 were hospitalized with flu-related illness in the past several months. That's more than 2 1/2 times higher than any other recent season. This flu season started in early December, a month earlier than usual, and peaked by the end of year. Since then, flu reports have been dropping off throughout the country.",
            "Babar wonders how he can get new clothing. Luckily, a very rich old man who has always been fond of little elephants understands right away that he is longing for a fine suit. As he likes to make people happy, he gives him his wallet. ",
            "The city councilmen refused the demonstrators a permit because they feared violence.",
            "Dan tried to stop Bill from getting help for the injured bird. He is very callous.",
            "A half hour later the Vice President arrived .",
            "Lawrence stared a minute at the lighted ribbon of traffic , hoping that a clue to his dislike of the Vice President would appear .",
            "Poverty imposes a kind of chastity on the ambitious .",
            "This meant sorting out press clippings and the like .",
            "Mickie sat over his second whisky-on-the-rocks in a little bar next to the funeral parlor on Pennsylvania Avenue",
            "Within two weeks Warren was ringing the bell at the abbey gate .",
            "He and Warren had traveled together for four days .",
            "With leather cups fitted in his handlebars , he steered his bicycle .",
            "The warped , broken trees in the valley assumed wraith-like shapes ."
        ];

        // fill out the senetnces to the dropdown
        sampleSentences.forEach(function (sent, i) {
            var area = $("#dropdownMenuArea1");
            var sentence = sent;
            if (sent.length > 50) {
                sentence = sent.substring(0, 50) + " ...";
            }
            area.append("<li><a href='#' id='action-" + i + "'>" + sentence + "</a></li>");

            // default text
            if (i == 0 && !page_rendered) {
                $("#viz-text").val(sent);
            }

            // set the sentence in the text-area
            jQuery("#action-" + i).click(function (e) {
                e.preventDefault();
                $("#viz-text").val(sent);
            });
        });
        if (page_rendered) {
            $("#viz-text").val($("#render-text").text());
            // select the views
            var viewNamesToCheck = $("#render-views").text().split(",");
            setSelectValues(document.getElementById('view-selector'), new Set(viewNamesToCheck));
            updatePage();
        }

        function getAllActiveViews() {
            var optionsMainpipeline = getSelectValues(document.getElementById('view-selector'));
            console.log(optionsMainpipeline);
            var optionsTransliteration = getSelectValues(document.getElementById('transliteration-selector'));
            console.log(optionsTransliteration);
            return optionsMainpipeline.concat(optionsTransliteration);/*.filter(function (e) {
                return e !== 'TRANSLITERATION'
            });*/
        }

        function getDynamicLink() {
            var views = getAllActiveViews().join();
            var text = $("#viz-text").val();
            return "http://nlp.cogcomp.org/render?text=" + text + "&viewNames=" + views;
        }

        // set popover with links
        $('[data-toggle="popover"]').popover();
        var htmlContent = "Dymanic link: <input type='text' onfocus='this.select();' id='dynamic-link' onmouseup='return false;' style='width: 180pt'/>";
        $("#main-popover").attr("data-content", htmlContent);
        $("#main-popover").click(function () {
            var link = getDynamicLink();
            console.log(link);
            $("#dynamic-link").val(link);
        });

        function updatePage() {
            // loader active
            document.getElementById("loader-main").style.visibility = "visible";
            externalAnnotatorServers.forEach(function (url, i) {
                document.getElementById("loader-ex-" + i).style.visibility = "visible";
            });
            var pipelineViews = getAllActiveViews();

            var text = $("#viz-text").val();
            console.log("Submit event: ");
            console.log(text);
            console.log($("#viz-text"));
            console.log("pipelineViews: ");
            console.log(pipelineViews);

            function sendRequest(api, loaderId) {
                var p = text ? Promise.resolve(text) : Promise.reject("Invalid Text");
                p.then(function (text) {
                    $("#render-area").empty();
                    console.log("pipelineViews: " + pipelineViews);
                    return apelles.pipelineClient.annotateText({}, text, pipelineViews, api).then(function (jsonData) {
                        return jsonData;
                    }, function (err) {
                        // return empty annotation
                        return [];
                    });
                }).then(function (jsonData) {
                    var availableViews = apelles.getAvailableViews(jsonData);
                    console.log("availableViews: ");
                    console.log(availableViews);
                    var viewInfos = _.filter(availableViews, function (viewInfo) {
                        return $.inArray(viewInfo.type, apelles.supportedTypes) !== -1 && viewInfo.name !== "TOKENS";
                    });

                    _.forEach(viewInfos, function (viewInfo) {
                        console.log("viewInfo: ");
                        console.log(viewInfo);
                        if (!pipelineViews.includes(viewInfo.name)) return;

                        console.log("Rendering: " + viewInfo.name);
                        var divId = viewInfo.name;
                        var newDiv = createViewArea(divId, viewInfo.name, viewInfo.type);
                        $("#render-area").append(newDiv);

                        apelles.render(jsonData, divId, viewInfo, brat_options);
                    });
                    document.getElementById(loaderId).style.visibility = "hidden";

                    // then reset it
                    console.log("reset the page");
                    $("#render-info").text("_content_rendered_");
                }, function (err) {
                    // do nothing
                });
            }

            // main server
            sendRequest(pipelineServer, "loader-main");

            // external annotations server
            externalAnnotatorServers.forEach(function (url, i) {
                sendRequest(url, "loader-ex-" + i);
            });
        }

        var createViewArea = function (renderDivId, viewName, viewType) {
            var outerDiv = $("<div>").attr("class", "view-area");
            var newblock = $("<div class='alert alert-success alert-success fade in visualization-block' role='alert'>").attr("id", renderDivId);
            var viewTypeShort = viewType.split(".").pop();
            var text = " <b> View Name: </b> " + viewName + ", <b>View Type: </b> " + viewTypeShort;
            var dropup = "<div class='dropup' id='dropup'> " +
              "<button class='btn btn-sm btn-success dropdown-toggle' type='button' data-toggle='dropdown'>" +
              "<span class='caret'></span></button> <ul class='dropdown-menu'> " +
//              "<li><a href='#' onclick='downloadImage(`" + viewName + "`);'>Download as PNG</a></li>" +
              '<li><button class="btn" data-clipboard-action="cut" data-clipboard-target="#svg-code" style="background-color: transparent; color: #333" onclick="return setTextArea(`' + viewName + '`);">Copy embeddable html to clipboard</button> </li>' +
              "</ul>" +
              "</div>";
            var closeButton = "<a href='' class='close' data-dismiss='alert' aria-label='close'><b>&times;</b></a>";
            var headerContent = "<form class='form-inline' role='form'> <div class='form-group'> " + dropup +
              "</div><div class='form-group' style='margin-left: 0.3cm'>" + text + "</div>" + closeButton + "</form>";
            newblock.append(headerContent);
            outerDiv.append(newblock);
            return outerDiv;
        };

        $("#viz-submit").click(function (eventData) {
            updatePage()
        });
    });
    function sleep(time) {
        return new Promise((resolve) => setTimeout(resolve, time));
    }

    function setTextArea(id) {
        var mySVG = $("#" + id)[0];
        var text = mySVG.innerHTML;
        text = '<link rel="stylesheet" type="text/css" href="http://nlp.cogcomp.org/embed.css">' + text.substring(text.indexOf("<svg"));
        text = text.replace("width: 908px; ", "");
        $("#svg-code").val(text);
        return false;
    }
</script>
</body>
</html>
